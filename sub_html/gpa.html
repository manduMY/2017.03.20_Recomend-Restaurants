<!DOCTYPE html>
<html>
  <head>
      <meta charset="utf-8">
      <title>rating test</title>
      <script src="https://code.jquery.com/jquery-3.1.1.js"></script> <!-- jQuery CDN 호스트 사용 -->
      <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
      <script type="text/javascript" src="../js/rating.js"></script>
      <link rel="stylesheet" href="../css/rating.css" type="text/css" media="screen" title="Rating CSS">
  </head>
  <body>
      <section class="container">
          <input type="radio" name="example" class="rating" value="1" />
          <input type="radio" name="example" class="rating" value="2" />
          <input type="radio" name="example" class="rating" value="3" />
          <input type="radio" name="example" class="rating" value="4" />
          <input type="radio" name="example" class="rating" value="5" />
      </section>
      <hr>
      <button onclick="gpa_clicked()" type="button" name="button">평점</button>
      <script type="text/javascript">
        var gpa;  //평점수를 전역으로 둠.
        var result; //임시 평점을 담아 둘 변수
        $(document).ready(function(){
          $('.container').rating(function(vote, event){
            gpa = vote;
            //document.getElementById('result').innerHTML = vote;
          });
        });

        var gpa_clicked = function(){
          if(gpa == undefined) {alert('평가를 해주세요!');}
          else {
            alert('평가되었습니다.');

            if(localStorage.getItem("gpa_category") == "food")
            {
              if(localStorage.getItem("id_number") == 1)
              {
                localStorage.setItem("food1_gpacnt", Number(localStorage.getItem("food1_gpacnt")) + 1);
                localStorage.setItem("food1_gpasum", Number(localStorage.getItem("food1_gpasum")) + Number(gpa));
                result = Number(localStorage.getItem("food1_gpasum")) / Number(localStorage.getItem("food1_gpacnt"));
                localStorage.setItem("food1_gpa", result.toFixed(2));
                //alert('gpa_cnt : ' + Number(localStorage.getItem("food1_gpacnt")));
                //alert('gpa_sum : ' + Number(localStorage.getItem("food1_gpasum")));
                //alert('gpa : ' + Number(localStorage.getItem("food1_gpa")));
              }
            }
            else if(localStorage.getItem("gpa_category") == "shop")
            {
              if(localStorage.getItem("id_number") == 1)
              {
                localStorage.setItem("shop1_gpacnt", Number(localStorage.getItem("shop1_gpacnt")) + 1);
                localStorage.setItem("shop1_gpasum", Number(localStorage.getItem("shop1_gpasum")) + Number(gpa));
                result = Number(localStorage.getItem("shop1_gpasum")) / Number(localStorage.getItem("shop1_gpacnt"));
                localStorage.setItem("shop1_gpa", result.toFixed(2));
                //alert('gpa_cnt : ' + Number(localStorage.getItem("shop1_gpacnt")));
                //alert('gpa_sum : ' + Number(localStorage.getItem("shop1_gpasum")));
                //alert('gpa : ' + Number(localStorage.getItem("shop1_gpa")));
              }
            }
            else if(localStorage.getItem("gpa_category") == "play")
            {
              if(localStorage.getItem("id_number") == 1)
              {
                localStorage.setItem("play1_gpacnt", Number(localStorage.getItem("play1_gpacnt")) + 1);
                localStorage.setItem("play1_gpasum", Number(localStorage.getItem("play1_gpasum")) + Number(gpa));
                result = Number(localStorage.getItem("play1_gpasum")) / Number(localStorage.getItem("play1_gpacnt"));
                localStorage.setItem("play1_gpa", result.toFixed(2));
                //alert('gpa_cnt : ' + Number(localStorage.getItem("play1_gpacnt")));
                //alert('gpa_sum : ' + Number(localStorage.getItem("play1_gpasum")));
                //alert('gpa : ' + Number(localStorage.getItem("play1_gpa")));
              }
            }
            else if(localStorage.getItem("gpa_category") == "inn")
            {
              if(localStorage.getItem("id_number") == 1)
              {
                localStorage.setItem("inn1_gpacnt", Number(localStorage.getItem("inn1_gpacnt")) + 1);
                localStorage.setItem("inn1_gpasum", Number(localStorage.getItem("inn1_gpasum")) + Number(gpa));
                result = Number(localStorage.getItem("inn1_gpasum")) / Number(localStorage.getItem("inn1_gpacnt"));
                localStorage.setItem("inn1_gpa", result.toFixed(2));
                //alert('gpa_cnt : ' + Number(localStorage.getItem("inn1_gpacnt")));
                //alert('gpa_sum : ' + Number(localStorage.getItem("inn1_gpasum")));
                //alert('gpa : ' + Number(localStorage.getItem("inn1_gpa")));
              }
            }
            else if(localStorage.getItem("gpa_category") == "beauty")
            {
              if(localStorage.getItem("id_number") == 1)
              {
                localStorage.setItem("beauty1_gpacnt", Number(localStorage.getItem("beauty1_gpacnt")) + 1);
                localStorage.setItem("beauty1_gpasum", Number(localStorage.getItem("beauty1_gpasum")) + Number(gpa));
                result = Number(localStorage.getItem("beauty1_gpasum")) / Number(localStorage.getItem("beauty1_gpacnt"));
                localStorage.setItem("beauty1_gpa", result.toFixed(2));
                //alert('gpa_cnt : ' + Number(localStorage.getItem("beauty1_gpacnt")));
                //alert('gpa_sum : ' + Number(localStorage.getItem("beauty1_gpasum")));
                //alert('gpa : ' + Number(localStorage.getItem("beauty1_gpa")));
              }
            }
          }
        };
      </script>
  </body>
</html>
